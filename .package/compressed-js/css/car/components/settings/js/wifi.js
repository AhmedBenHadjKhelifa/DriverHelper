var Wifi=function(){"use strict";var e=this;this.togglePower=function(){console.log("Wifi: toggle power called."),!!e.adapter()&&!e.togglePowerLocked()&&(e.rescanEnabled(!1),e.togglePowerLocked(!0),e.isPowered()?(showLoadingSpinner("Turning off"),e.adapter().technology.setPowered(!1,function(){console.log("Successfully disable wifi subsystem"),e.togglePowerLocked(!1),e.setAdapterProperty("Powered",!1),hideLoadingSpinner("Turning off"),e.rescanEnabled(!0)},function(t){var n="An error occured while turning wifi off.";console.log(n,t),e.togglePowerLocked(!1),hideLoadingSpinner("Turning off"),alert(n),e.rescanEnabled(!0)})):(showLoadingSpinner("Turning on"),e.adapter().technology.setPowered(!0,function(){console.log("Successfully enable WiFi subsystem"),e.togglePowerLocked(!1),e.setAdapterProperty("Powered",!0),hideLoadingSpinner("Turning on"),e.scanNetwork()},function(t){var n="An error occured while turning wifi on.";console.log(n,t),e.togglePowerLocked(!1),hideLoadingSpinner("Turning on"),alert(n),e.rescanEnabled(!0)})))},this.toggleConnection=function(t){console.log("Wifi: toggle connection called.",t),t?!e.isConnected(t.prop)&&e.getEncryptionStr(t.prop).toString().trim().toLowerCase()!=="none"?e.showEnterWifiPasswordPopup(t):e.connectDisconnectNetwork(t,undefined):console.log("Supplied network is undefined.")},this.openNetworkDetails=function(t){console.log("Wifi: open network details called.",t),e.selectedNetwork(null);if(!!t){e.selectedNetwork(t);var n={textTitle:"NETWORK INFO",textSubtitle:e.getSsidStr(t.prop),actionName:"BACK",action:function(){Settings.openSetting(Settings.selectedSetting)}},r="wifiNetworkInfoContent",i=function(e,t){var n='<div class="wifiNetworkInfoElement fontSizeLarge fontWeightBold fontColorNormal">';return n+="<span>",n+=e,n+=": ",n+="</span>",n+='<span data-bind="text:'+t+'">',n+="</span>",n+="</div>",n},s=function(){if(!$("#wifiNetworkInfoBox").length){var e="";e+='<div id="wifiAutoConnectButton" class="toggleButton subPanelToggleButton subPanelToggleButtonWide" data-bind="with: Settings.Wifi.selectedNetwork, click: Settings.Wifi.toggleSelectedNetworkAutoConnect">',e+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',e+='<div class="fontColorNormal fontSizeMedium fontWeightBold toggleButtonText" data-bind="text: \'AUTO CONNECT\', css: { fontColorSelected: Settings.Wifi.isAutoConnect(prop) }"></div>',e+="</div>",$(e).appendTo($(".tabsTopSubPanel"));var t='<div id="wifiNetworkInfoBox" data-bind="with: Settings.Wifi.selectedNetwork">';t+=i("SSID","Settings.Wifi.getSsidStr(prop)"),t+=i("Encryption","Settings.Wifi.getEncryptionStr(prop)"),t+=i("Security","Settings.Wifi.getSecurityStr(prop)"),t+=i("Signal Strength","Settings.Wifi.getSignalStrengthNum(prop)"),t+=i("Connected","Settings.Wifi.isConnected(prop) ? 'Yes' : 'No'"),t+='<div data-bind="with: Settings.Wifi.isConnected(prop)">',t+=i("Internet Access","Settings.Wifi.isOnlineWifiNetwork($parent.id) ? 'Yes' : 'No'"),t+=i("IP Address","Settings.Wifi.getIpAddressStr($parent.prop)"),t+=i("Method","Settings.Wifi.getMethodStr($parent.prop)"),t+=i("Gateway","Settings.Wifi.getGatewayAddressStr($parent.prop)"),t+=i("Netmask","Settings.Wifi.getNetmaskAddressStr($parent.prop)"),t+="</div>",t+='<div id="networkConnectButton" class="toggleButton networkConnectButton" data-bind="click: Settings.Wifi.toggleConnection">',t+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',t+="<div class=\"fontColorNormal fontSizeMedium fontWeightBold toggleButtonText\" data-bind=\"text: Settings.Wifi.isConnected(prop) ? 'DISCONNECT' : 'CONNECT'\"></div>",t+="</div>",t+="</div>",$(t).appendTo($("."+r)),ko.applyBindings(window.Settings)}};Settings.domElement.tabs("clearContent"),Settings.domElement.tabs("changeContentClass",r),Settings.domElement.tabs("subpanelContentTemplateCompile",n,s)}},this.toggleSelectedNetworkAutoConnect=function(){console.log("Wifi: toggle auto connect called",e.selectedNetwork());if(!!e.selectedNetwork()&&!!e.selectedNetwork().service&&!!e.selectedNetwork().prop()){e.rescanEnabled(!1);var t=!e.selectedNetwork().prop().AutoConnect;e.selectedNetwork().service.setAutoConnect(t,function(){console.log("AutoConnect set"),e.setNetworkProperty(e.selectedNetwork(),"AutoConnect",t),e.scan(!1),e.rescanEnabled(!0)},function(t){console.log("AutoConnect set failed",t),e.scan(!1),e.rescanEnabled(!0)})}},this.scanNetwork=function(){console.log("Wifi: scan network called."),e.stopScan(),showLoadingSpinner("Scanning"),e.showWifiLoadingSpinner(),setTimeout(function(){e.scan(!0),e.rescanEnabled(!0)},1e3)},this.showAddNetwork=function(){console.log("Wifi: connect to hidden network called."),e.showAddNetworkPopup()},this.getSsidStr=function(e){var t="UNKNOWN";return!!e()&&!!e().Name&&e().Name!==""&&(t=e().Name.toString().trim().toUpperCase()),t},this.getSignalStrengthStr=function(e){var t="UNKNOWN";if(!!e()&&!!e().Strength){var n=e().Strength;n>0&&n<=20?n="VERY POOR":n>20&&n<=40?t="POOR":n>40&&n<=70?t="AVERAGE":n>70&&n<=90?t="GOOD":n>90&&n<=100&&(t="EXCELLENT")}return t},this.getSignalStrengthNum=function(e){var t=0;return!!e()&&!!e().Strength&&(t=e().Strength),t},this.getEncryptionStr=function(e){var t="UNKNOWN";return!!e()&&!!e().EncryptionMode&&e().EncryptionMode.toString().trim()!==""&&(t=e().EncryptionMode.toString().trim().toUpperCase()),t},this.getSecurityStr=function(e){var t="UNKNOWN";return!!e()&&!!e().Security&&e().Security.length&&(t=e().Security.join(", ").toString().trim().toUpperCase()),t},this.isConnected=function(e){var t=!1;return!!e()&&!!e().State&&e().State.toString().trim()!==""&&(e().State.toString().trim().toLowerCase()==="ready"||e().State.toString().trim().toLowerCase()==="online")&&(t=!0),t},this.isAutoConnect=function(e){var t=!1;return!!e()&&!!e().AutoConnect&&e().AutoConnect!==undefined&&(t=e().AutoConnect),t},this.getIpAddressStr=function(e){var t="UNKNOWN";return!!e()&&!!e().IPv4&&!!e().IPv4.Address&&e().IPv4.Address.toString().trim()!==""&&(t=e().IPv4.Address.toString().trim().toUpperCase()),t},this.getMethodStr=function(e){var t="UNKNOWN";return!!e()&&!!e().IPv4&&!!e().IPv4.Method&&e().IPv4.Method.toString().trim()!==""&&(t=e().IPv4.Method.toString().trim().toUpperCase()),t},this.getGatewayAddressStr=function(e){var t="UNKNOWN";return!!e()&&!!e().IPv4&&!!e().IPv4.Gateway&&e().IPv4.Gateway.toString().trim()!==""&&(t=e().IPv4.Gateway.toString().trim().toUpperCase()),t},this.getNetmaskAddressStr=function(e){var t="UNKNOWN";return!!e()&&!!e().IPv4&&!!e().IPv4.Netmask&&e().IPv4.Netmask.toString().trim()!==""&&(t=e().IPv4.Netmask.toString().trim().toUpperCase()),t},this.isPowered=function(){var t=!1;return!!e.adapter()&&!!e.adapter().prop()&&e.adapter().prop().Powered!==undefined&&(t=e.adapter().prop().Powered),t},this.isTethering=function(){var t=!1;return!!e.adapter()&&!!e.adapter().prop()&&e.adapter().prop().Tethering!==undefined&&(t=e.adapter().prop().Tethering),t},this.getTetheringIdentifierStr=function(){var t="";return!!e.adapter()&&!!e.adapter().prop()&&!!e.adapter().prop().TetheringIdentifier&&e.adapter().prop().TetheringIdentifier.toString().trim()!==""&&(t=e.adapter().prop().TetheringIdentifier),t},this.getTetheringPassphraseStr=function(){var t="";return!!e.adapter()&&!!e.adapter().prop()&&!!e.adapter().prop().TetheringPassphrase&&e.adapter().prop().TetheringPassphrase.toString().trim()!==""&&(t=e.adapter().prop().TetheringPassphrase),t},this.getSecurityStrByIndex=function(t){return t<0&&(t=0),t>=e.SECURITY_TYPE.length&&(t=e.SECURITY_TYPE.length-1),e.SECURITY_TYPE[t]},this.getPasswordLengthStr=function(e){var t={str:"",min:0,max:0};switch(e){case 1:t.str="13 ASCII CHARACTERS",t.min=13,t.max=13;break;case 2:t.str="8-63 ASCII CHARACTERS",t.min=8,t.max=63;break;case 3:t.str="8-63 ASCII CHARACTERS",t.min=8,t.max=63;break;default:}return t},this.isASCII=function(e){return/^[\x00-\x7F]*$/.test(e)},this.isPasswordValid=function(t,n,r){return e.isASCII(t)&&t.length>=n&&t.length<=r?!0:!1},this.toggleTethering=function(){console.log("Wifi: toggle tethering called."),showLoadingSpinner("Processing"),e.isPowered()?e.setTethering(!e.isTethering()):e.adapter().technology.setPowered(!0,function(){console.log("Successfully enable WiFi subsystem"),e.setAdapterProperty("Powered",!0),setTimeout(function(){e.setTethering(!e.isTethering())},1e3)},function(e){var t="An error occured while turning wifi on.";console.log(t,e),hideLoadingSpinner("Processing"),alert(t)})},this.toggleHandover=function(){console.log("Wifi: handover sequence called."),alert("Wifi handover sequence not supported.")},this.isOnlineWifiNetwork=function(t){return!e.onlineWifiNetwork()||e.onlineWifiNetwork()!==t?!1:!0},Settings.domElement.on("eventClick_hidePage",function(){e.rescanEnabled(!1)}),Settings.domElement.on("eventClick_showPage",function(){($(".wifiContent").length||$(".wifiNetworkInfoContent").length)&&e.rescanEnabled(!0)})};Wifi.prototype.networks=ko.observableArray([]),Wifi.prototype.hiddenNetworks=ko.observableArray([]),Wifi.prototype.adapter=ko.observable(null),Wifi.prototype.selectedNetwork=ko.observable(null),Wifi.prototype.scanning=ko.observable(!1),Wifi.prototype.firstScan=ko.observable(!0),Wifi.prototype.rescanEnabled=ko.observable(!1),Wifi.prototype.rescanInterval=null,Wifi.prototype.SECURITY_TYPE=["NONE","WEP","WPA","WPA2"],Wifi.prototype.onlineWifiNetwork=ko.observable(null),Wifi.prototype.togglePowerLocked=ko.observable(!1),Wifi.prototype.tetheringSecurity=ko.observable(3),Wifi.prototype.init=function(e){"use strict";var t=this,n=null;loadScript(Settings.SETTINGS_JS_PATH+"websocket.js",function(r,i){i==="ok"?loadScript(Settings.SETTINGS_JS_PATH+"api-connman.js",function(r,i){i==="ok"?wsAPI.connect("ws://localhost:16000/","http-only",function(){console.log("Settings daemon connected"),wsAPI.subscribeEvents(function(e){t.connmanEventReceived(e)}),t.loadDefaultAdapter(function(t){n=t,!e||e(n)})},function(t){console.log("Settings daemon disconnected...",t),t===null||t===undefined?(n="Error: Cannot connect to settings daemon",console.log(n)):(n=t,console.log("Error",n)),!e||e(n)}):(n="Error: Connamn API is not available",console.log(n),!e||e(n))}):(n="Error: Websocket API is not available",console.log(n),!e||e(n))})},Wifi.prototype.connmanEventReceived=function(e){"use strict";var t=this;console.log("EVENT: ",e);if(e.type===WS_EVENT_TYPE.CONNMAN)if(e.name==="PropertyChanged"){var n=e.id,r=e.value;if(!!t.adapter()){var i=n.lastIndexOf("/"),s=n.substring(i+1).toString().trim().toLowerCase();s==="wifi"&&(t.setAdapterProperty(r[0],r[1]),r[0]==="Powered"&&(r[1]?setTimeout(function(){t.scan(!1)},2e3):t.stopScan()),r[0]==="Tethering"&&(r[1]?t.stopScan():setTimeout(function(){t.scan(!1)},2e3)),r[0]==="Connected"&&t.checkOnlineWifiNetwork())}}else console.log("Unsupported event received: "+e.name)},Wifi.prototype.setTethering=function(e){"use strict";var t=this;console.log("setTethering called");if($(".wifiTetheringContent").length&&!!t.adapter()){var n=$(".wifiTetheringContent"),r=n.find($("#inputSsid")).val().toString().trim(),i=n.find($("#inputPassword")).val().toString().trim();t.validateWifiCredentials(r,t.tetheringSecurity(),i)?(showLoadingSpinner("Processing"),t.adapter().technology.setTethering(r,i,e,function(){console.log("SUCCESS"),hideLoadingSpinner("Processing")},function(e){console.log("ERROR",e),alert(e),hideLoadingSpinner("Processing")})):hideLoadingSpinner("Processing")}},Wifi.prototype.loadDefaultAdapter=function(e){"use strict";var t=this,n=null;typeof settings!="undefined"&&typeof settings.connman!="undefined"&&typeof settings.connman.getTechnologies!="undefined"?settings.connman.getTechnologies(function(r){for(var i=0;i<r.length;i++){var s=r[i];if(s.prop.Type==="wifi"){console.log("Connman technology found: ",s),t.adapter({id:s.id,prop:ko.observable(s.prop),technology:s});break}}t.adapter()?t.adapter().prop().Powered===undefined?t.updatePowered(function(){!e||e()},function(t){n=t,!e||e(n)}):!e||e():(n="Wifi technology not found.",console.log(n),!e||e(n))},function(t){n=t,console.log("getTechnologies error ",n),!e||e(n)}):(n="settings.connman.getTechnologies API not available.",console.log(n),!e||e(n))},Wifi.prototype.showNetworks=function(){"use strict";var e=this;e.rescanEnabled(!0);var t={textTitle:"SETTINGS",textSubtitle:"WIFI",actionName:"BACK",action:function(){e.rescanEnabled(!1),Settings.renderSettingsView()}},n=function(){if(!$("#bluetoothDevicesList").length){var t='<div id="wifiNetworksList" data-bind="template: { name: \'';t+=i,t+="', foreach: Settings.Wifi.networks }, style: { display: Settings.Wifi.isPowered() && !Settings.Wifi.isTethering() ? 'block' : 'none' }\"></div>",t+='<div style="text-align: center;" data-bind="style: { display: Settings.Wifi.isPowered() && Settings.Wifi.isTethering() ? \'block\' : \'none\' }" class="fontColorNormal fontSizeMedium fontWeightBold">TETHERING IS ON</div>',$(t).prependTo($("."+r));var n="";n+='<div class="buttonsArea">',n+='<div id="wifiRefreshButton" class="toggleButton wifiRefreshButton" data-bind="click: Settings.Wifi.scanNetwork, style: { display: Settings.Wifi.isPowered() && !Settings.Wifi.isTethering() ? \'block\' : \'none\' }">',n+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',n+='<div class="fontColorNormal fontSizeMedium fontWeightBold toggleButtonText">REFRESH</div>',n+="</div>",n+='<div id="addNetworkButton" class="toggleButton addNetworkButton" data-bind="click: Settings.Wifi.showAddNetwork, style: { display: Settings.Wifi.isPowered() && !Settings.Wifi.isTethering() ? \'block\' : \'none\' }">',n+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',n+='<div class="fontColorNormal fontSizeMedium fontWeightBold toggleButtonText">ADD</div>',n+="</div>",n+="</div>",$(n).appendTo($("."+r)),n='<div id="wifiPowerButton" class="toggleButton subPanelToggleButton subPanelToggleButtonWide" data-bind="with: Settings.Wifi.adapter, click: Settings.Wifi.togglePower">',n+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',n+="<div class=\"fontColorNormal fontSizeMedium fontWeightBold toggleButtonText\" data-bind=\"text: Settings.Wifi.isPowered() ? 'TURN OFF' : 'TURN ON'\"></div>",n+="</div>",$(n).appendTo($(".tabsTopSubPanel")),ko.applyBindings(window.Settings),e.scan(e.firstScan()),e.rescanInterval||(e.rescanInterval=setInterval(function(){e.isPowered()&&!e.isTethering()&&!e.scanning()&&e.rescanEnabled()&&!document.webkitHidden&&e.scan(!1)},5e3))}},r="wifiContent",i="template-wifi";Settings.domElement.tabs("clearContent"),Settings.domElement.tabs("changeContentClass",r),Settings.domElement.tabs("subpanelContentTemplateCompile",t,function(){loadTemplate(Settings.SETTINGS_TEMPLATES_PATH,i,n)})},Wifi.prototype.showWifiLoadingSpinner=function(){"use strict";var e=this;if($(".wifiContent").length){if(!$("#loadingSpinnerWifi").length){var t="";t+='<div id="loadingSpinnerWifi" class="loadingSpinnerWifi loading-container loading-container-small">',t+='<div class="loading loading-small"></div>',t+="</div>",$(t).appendTo($(".tabsTopSubPanel"))}$("#loadingSpinnerWifi").show()}},Wifi.prototype.hideWifiLoadingSpinner=function(){"use strict";var e=this;$("#loadingSpinnerWifi").length&&$("#loadingSpinnerWifi").hide()},Wifi.prototype.scan=function(e){"use strict";var t=this;if(t.scanning()){t.showWifiLoadingSpinner();return}t.isPowered()&&!t.isTethering()?(e=typeof e=="undefined"?!0:e,e&&showLoadingSpinner("Scanning"),t.showWifiLoadingSpinner(),t.scanning(!0),t.firstScan(!1),settings.connman.scan(t.adapter().id,function(e){var n=ko.utils.arrayFilter(e,function(e){return!!e&&!!e.prop&&!!e.prop.Type&&e.prop.Type==="wifi"}),r=[],i=[];ko.utils.arrayForEach(n,function(e){var t={id:e.id,prop:ko.observable(e.prop),service:e};e.prop.Name?r.push(t):i.push(t)}),console.log("Found wifi networks: ",r),console.log("Found wifi hidden networks: ",i),t.networks(r),t.hiddenNetworks(i),t.sortNetworks(),t.checkOnlineWifiNetwork();for(var s=0;s<t.networks().length;++s){var o=t.networks()[s];!!t.selectedNetwork()&&t.selectedNetwork().id===o.id&&t.selectedNetwork(o)}t.scanning(!1),hideLoadingSpinner("Scanning"),t.hideWifiLoadingSpinner()},function(e){console.log("Error: Cannot scan: "+e),t.scanning(!1),hideLoadingSpinner("Scanning"),t.hideWifiLoadingSpinner()})):console.log("Wifi adapter is null or is turned off.")},Wifi.prototype.stopScan=function(){"use strict";var e=this;e.scanning(!1),e.clearNetworks(),hideLoadingSpinner("Scanning"),e.hideWifiLoadingSpinner()},Wifi.prototype.checkOnlineWifiNetwork=function(){"use strict";var e=this;console.log("Wifi: checking internet access");var t=function(t){$.ajax({type:"GET",url:"http://www.google.com",timeout:1e3,success:function(n,r,i){e.onlineWifiNetwork(t.id)},error:function(t,n,r){e.onlineWifiNetwork(null)}})};for(var n=0;n<e.networks().length;++n){var r=e.networks()[n];if(e.isConnected(r.prop)){t(r);return}}e.onlineWifiNetwork(null)},Wifi.prototype.updatePowered=function(e,t){"use strict";var n=this;if(!this.adapter()){var r="Error: Wifi adapter not found.";console.log(r),!t||t(r)}else this.adapter().getPowered(function(t){console.log("Wifi adapter is powered: "+t),n.setAdapterProperty("Powered",t),!e||e()},function(e){console.log("Error: Cannot get WiFi powered state: "+e),n.setAdapterProperty("Powered",!1),!t||t(e)})},Wifi.prototype.clearNetworks=function(){"use strict";this.networks.removeAll(),this.networks([]),this.hiddenNetworks.removeAll(),this.hiddenNetworks([])},Wifi.prototype.refreshNetworks=function(){"use strict";var e=this,t=e.networks().slice(0),n=e.hiddenNetworks().slice(0);e.clearNetworks(),e.networks(t),e.hiddenNetworks(n),e.sortNetworks()},Wifi.prototype.sortNetworks=function(){"use strict";var e=this;!!e.networks()&&e.networks().length&&e.networks.sort(function(t,n){return e.isConnected(t.prop)===e.isConnected(n.prop)?0:e.isConnected(t.prop)?-1:1})},Wifi.prototype.setNetworkProperty=function(e,t,n){"use strict";var r=this;!!e&&!!e.prop()&&(e.prop()[t]=n,e.prop.valueHasMutated(),e.service.prop[t]=n,!!r.selectedNetwork()&&r.selectedNetwork().id===e.id&&r.selectedNetwork.valueHasMutated())},Wifi.prototype.setAdapterProperty=function(e,t){"use strict";var n=this;!!n.adapter()&&!!n.adapter().prop()&&(n.adapter().prop()[e]=t,n.adapter().technology.prop[e]=t,n.adapter().prop.valueHasMutated())},Wifi.prototype.connectDisconnectNetwork=function(e,t,n){"use strict";var r=this,i=null;!!e&&r.isPowered()?(r.rescanEnabled(!1),r.isConnected(e.prop)?(showLoadingSpinner("Disconnecting"),console.log("Wifi disconnect from network: "+r.getSsidStr(e.prop)),e.service.disconnect(function(){console.log("WiFi disconnected from "+r.getSsidStr(e.prop)),r.setNetworkProperty(e,"State","idle"),r.scan(!1),hideLoadingSpinner("Disconnecting"),r.rescanEnabled(!0),!n||n()},function(t){console.log("Error: Network disconnect failed: ",t),t.indexOf("Error.NotConnected")!==-1&&r.setNetworkProperty(e,"State","idle"),r.scan(!1),hideLoadingSpinner("Disconnecting"),r.rescanEnabled(!0),i=t,!n||n(i)})):(showLoadingSpinner("Connecting"),console.log("WiFi connect to network: "+r.getSsidStr(e.prop)),e.service.connect(undefined,t,undefined,function(){console.log("WiFi connected to "+r.getSsidStr(e.prop)),r.setNetworkProperty(e,"State","ready"),r.scan(!1),hideLoadingSpinner("Connecting"),r.rescanEnabled(!0),!n||n()},function(t){console.log("Error: WiFi connect failed: ",t),t.indexOf("Error.AlreadyConnected")!==-1&&r.setNetworkProperty(e,"State","ready"),r.scan(!1),hideLoadingSpinner("Connecting"),r.rescanEnabled(!0),i=t,!n||n(i)}))):(i="Supplied network is undefined or wifi adapter is turned off.",console.log(i),!n||n(i))},Wifi.prototype.showEnterWifiPasswordPopup=function(e){"use strict";var t=this,n="";n+='<div class="popupContainer pageBgColorNormalTransparent">',n+='<div class="popupContainerWrapper">',n+='<div class="popupWrapper borderColorTheme boxShadow1 bgColorNormal">',n+='<div class="popupHeader fontSizeLarge fontWeightBold fontColorTheme borderColorTheme">',n+=t.getSsidStr(e.prop),n+="</div>",n+='<div class="popupContent">',n+='<div class="popupContentContainer">',n+='<span class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="Signal Strength",n+="</span>",n+='<span class="popupContentContainerValue fontSizeMedium fontWeightBold fontColorNormal">',n+=t.getSignalStrengthStr(e.prop),n+="</span>",n+="</div>",n+='<div class="popupContentContainer">',n+='<span class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="Security",n+="</span>",n+='<span class="popupContentContainerValue fontSizeMedium fontWeightBold fontColorNormal">',n+=t.getSecurityStr(e.prop),n+="</span>",n+="</div>",n+='<div class="popupContentContainer">',n+='<div class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="Password",n+="</div>",n+='<div class="inputBox popupInputBox">',n+='<input id="inputPassword" class="input fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text"/>',n+='<div id="buttonDeletePassword" class="button deleteButton"></div>',n+="</div>",n+="</div>",n+="</div>",n+='<div class="popupFooter borderColorTheme">',n+='<div id="cancelButton" class="popupButton">',n+='<div class="bgColorThemeTransparent boxShadowInset popupButtonBackground"></div>',n+='<div class="fontColorNormal fontSizeMedium fontWeightBold popupButtonText">CANCEL</div>',n+="</div>",n+='<div id="connectButton" class="popupButton">',n+='<div class="bgColorThemeTransparent boxShadowInset popupButtonBackground"></div>',n+='<div class="fontColorNormal fontSizeMedium fontWeightBold popupButtonText">CONNECT</div>',n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n=$(n),n.appendTo("body"),n.find("#buttonDeletePassword").click(function(){return t.deleteCharFromInput(n.find("#inputPassword")),!1}),n.find("#cancelButton").click(function(){return n.fadeOut("normal",function(){n.remove()}),!1}),n.find("#connectButton").click(function(){return t.connectDisconnectNetwork(e,n.find("#inputPassword").val(),function(e){e?alert("An error occured while connecting/disconnecting to/from network. "+e):n.fadeOut("normal",function(){n.remove()})}),!1}),n.fadeIn("normal",function(){})},Wifi.prototype.deleteCharFromInput=function(e){"use strict";var t=e.val();t=t.slice(0,t.length-1),e.val(t),e.focus()},Wifi.prototype.showAddNetworkPopup=function(){"use strict";var e=this,t="";t+='<div class="popupContainer pageBgColorNormalTransparent">',t+='<div class="popupContainerWrapper">',t+='<div class="popupWrapper borderColorTheme boxShadow1 bgColorNormal">',t+='<div class="popupHeader fontSizeLarge fontWeightBold fontColorTheme borderColorTheme">',t+="ADD NETWORK",t+="</div>",t+='<div class="popupContent">',t+='<div class="popupContentContainer">',t+='<div class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',t+="SSID",t+="</div>",t+='<div class="inputBox popupInputBox">',t+='<input id="inputSsid" class="input fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text" />',t+='<div id="buttonDeleteSsid" class="button deleteButton"></div>',t+="</div>",t+="</div>",t+='<div class="popupContentContainer">',t+='<div class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',t+="SECURITY",t+="</div>",t+='<div class="inputBox popupInputBox">',t+='<div id="buttonPreviousSecurity" class="button previousButton"></div>',t+='<input id="inputSecurity" class="inputSelection fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" data-securitytype="0" type="text" value="NONE" disabled />',t+='<div id="buttonNextSecurity" class="button nextButton"></div>',t+="</div>",t+="</div>",t+='<div id="inputPasswordContainer" class="popupContentContainer" style="display: none;">',t+='<div class="popupContentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',t+="PASSWORD",t+="</div>",t+='<div class="inputBox popupInputBox">',t+='<input id="inputPassword" class="input fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text"/>',t+='<div id="buttonDeletePassword" class="button deleteButton"></div>',t+="</div>",t+="</div>",t+="</div>",t+='<div class="popupFooter borderColorTheme">',t+='<div id="cancelButton" class="popupButton">',t+='<div class="bgColorThemeTransparent boxShadowInset popupButtonBackground"></div>',t+='<div class="fontColorNormal fontSizeMedium fontWeightBold popupButtonText">CANCEL</div>',t+="</div>",t+='<div id="addButton" class="popupButton">',t+='<div class="bgColorThemeTransparent boxShadowInset popupButtonBackground"></div>',t+='<div class="fontColorNormal fontSizeMedium fontWeightBold popupButtonText">ADD</div>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+="</div>",t=$(t),t.appendTo("body"),t.find("#buttonDeleteSsid").click(function(){return e.deleteCharFromInput(t.find("#inputSsid")),!1}),t.find("#buttonNextSecurity").click(function(){var n=t.find("#inputSecurity"),r=Number(n.data("securitytype"));return r+=1,r>=e.SECURITY_TYPE.length&&(r=0),r===0?$("#inputPasswordContainer").hide(0):$("#inputPasswordContainer").show(0),n.data("securitytype",r),n.attr("value",e.SECURITY_TYPE[r]),!1}),t.find("#buttonPreviousSecurity").click(function(){var n=t.find("#inputSecurity"),r=Number(n.data("securitytype"));return r-=1,r<0&&(r=e.SECURITY_TYPE.length-1),r===0?$("#inputPasswordContainer").hide(0):$("#inputPasswordContainer").show(0),n.data("securitytype",r),n.attr("value",e.SECURITY_TYPE[r]),!1}),t.find("#buttonDeletePassword").click(function(){return e.deleteCharFromInput(t.find("#inputPassword")),!1}),t.find("#cancelButton").click(function(){return t.fadeOut("normal",function(){t.remove()}),!1}),t.find("#addButton").click(function(){function f(){u=!0,e.scan(!1),hideLoadingSpinner("Connecting"),e.rescanEnabled(!0),t.fadeOut("normal",function(){t.remove()})}function l(t){var u=s[t];u?(console.log("Connecting to: "+u.id),u.service.connect(n,i,r,function(){console.log("WiFi connected to "+e.getSsidStr(u.prop)),f()},function(t){console.log("Error: WiFi connect failed: ",t),t.indexOf("Error.AlreadyConnected")!==-1?f():o+1<s.length?(o++,l(o)):(hideLoadingSpinner("Connecting"),e.rescanEnabled(!0),a="Wrong ssid/password or network is unavailable.",console.log(a),alert(a))})):(console.log("Supplied network is undefined."),hideLoadingSpinner("Connecting"),e.rescanEnabled(!0))}var n=t.find("#inputSsid").val().toString().trim(),r=t.find("#inputSecurity").data("securitytype"),i;r>0?(i=t.find("#inputPassword").val().toString().trim(),i=i===""?undefined:i,r=e.SECURITY_TYPE[r]):r=undefined,console.log(n,i,r);var s=e.hiddenNetworks().slice(0);i===undefined&&(s=ko.utils.arrayFilter(s,function(e){return!!e&&!!e.prop()&&!!e.prop().EncryptionMode&&e.prop().EncryptionMode==="none"}));var o=0,u=!1,a=null;return s.length?(showLoadingSpinner("Connecting"),e.rescanEnabled(!1),l(o)):(a="No hidden networks available.",console.log(a),alert(a)),!1}),t.fadeIn("normal",function(){})},Wifi.prototype.validateWifiCredentials=function(e,t,n){"use strict";var r=this;e=e.toString().trim(),n=n.toString().trim(),console.log("validating: ",e,t,n);if(e!==""){if(t>0){var i=r.getPasswordLengthStr(t);if(!i||i.str==="")return alert("Security type not supported"),!1;if(!r.isPasswordValid(n,i.min,i.max))return alert("Password must contain "+i.str),!1}return!0}return alert("Enter WiFi SSID."),!1},Wifi.prototype.showWifiTethering=function(){"use strict";function n(){if(!$("#wifiTetheringInfoBox").length){var t="";t+='<div id="tetheringPowerButton" class="toggleButton subPanelToggleButton subPanelToggleButtonWide" data-bind="click: Settings.Wifi.toggleTethering">',t+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',t+="<div class=\"fontColorNormal fontSizeMedium fontWeightBold toggleButtonText\" data-bind=\"text: Settings.Wifi.isTethering() ? 'TURN OFF' : 'TURN ON'\"></div>",t+="</div>",$(t).appendTo($(".tabsTopSubPanel"));var n='<div id="wifiTetheringInfoBox" data-bind="with: Settings.Wifi.adapter">';n+='<div class="contentContainer">',n+='<div class="contentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="IDENTIFIER",n+="</div>",n+='<div class="inputBox contentInputBox">',n+='<input id="inputSsid" data-bind="value: Settings.Wifi.getTetheringIdentifierStr()" class="input settingsInputWideInline fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text"/>',n+='<div id="buttonDeleteSsid" class="button deleteButton"></div>',n+="</div>",n+="</div>",n+='<div class="contentContainer">',n+='<div class="contentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="SECURITY",n+="</div>",n+='<div class="inputBox contentInputBox">',n+='<div id="buttonPreviousSecurity" class="button previousButton"></div>',n+='<input id="inputSecurity" data-bind="value: Settings.Wifi.getSecurityStrByIndex(Settings.Wifi.tetheringSecurity())" class="inputSelection settingsInputSelectionWideInline fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text" disabled />',n+='<div id="buttonNextSecurity" class="button nextButton"></div>',n+="</div>",n+="</div>",n+='<div id="inputPasswordContainer" class="contentContainer" data-bind="style: { display: Settings.Wifi.tetheringSecurity() == 0 ? \'none\' : \'block\' }">',n+='<div class="contentContainerKey fontSizeLarge fontWeightBold fontColorTheme">',n+="PASSPHRASE",n+="</div>",n+='<div class="inputBox contentInputBox">',n+='<input id="inputPassword" data-bind="value: Settings.Wifi.getTetheringPassphraseStr(), attr: { maxlength: Settings.Wifi.getPasswordLengthStr(Settings.Wifi.tetheringSecurity()).max, placeholder: Settings.Wifi.getPasswordLengthStr(Settings.Wifi.tetheringSecurity()).str }" class="input settingsInputWideInline fontSizeLarge fontSizeBold fontColorNormal boxShadow4 boxShadow4Active" type="text"/>',n+='<div id="buttonDeletePassword" class="button deleteButton"></div>',n+="</div>",n+="</div>",n+="<div class=\"disabledArea bgColorNormalTransparent\" data-bind=\"style: { display: Settings.Wifi.isTethering() ? 'block' : 'none' }\"></div>",n+="</div>",n+='<div class="buttonsArea">',n+='<div id="startWifiHandover" class="toggleButton wifiHandoverButton" data-bind="click: Settings.Wifi.toggleHandover">',n+='<div class="bgColorThemeTransparent boxShadowInset toggleButtonBackground"></div>',n+='<div class="fontColorNormal fontSizeMedium fontWeightBold toggleButtonText" data-bind="text: \'START WIFI HANDOVER\'"></div>',n+="</div>",n+="</div>",n=$(n),n.find("#inputSsid").on("change",function(){return!1}),n.find("#buttonDeleteSsid").click(function(){return e.deleteCharFromInput(n.find("#inputSsid")),!1}),n.find("#inputPassword").on("change",function(){return!1}),n.find("#buttonDeletePassword").click(function(){return e.deleteCharFromInput(n.find("#inputPassword")),!1}),n.find("#buttonNextSecurity").click(function(){return!1}),n.find("#buttonPreviousSecurity").click(function(){return!1}),n.appendTo("."+r),ko.applyBindings(window.Settings)}}var e=this,t={textTitle:"SETTINGS",textSubtitle:"WIFI TETHERING",actionName:"BACK",action:function(){Settings.renderSettingsView()}},r="wifiTetheringContent";Settings.domElement.tabs("clearContent"),Settings.domElement.tabs("changeContentClass",r),Settings.domElement.tabs("subpanelContentTemplateCompile",t,n)}